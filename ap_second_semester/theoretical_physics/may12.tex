\documentclass[main.tex]{subfiles}
\begin{document}

\section{T-products and Wick's theorem}

\marginpar{Saturday\\ 2020-6-13, \\ compiled \\ \today}

We have shown up to now that in order to describe an interacting QFT it is sufficient to: 
\begin{enumerate}
    \item know the free evolution of the fields, which is governed by \(H_0 \) and described in the Heisenberg picture;
    \item be able to calculate the time-evolution operator up to an arbitrary perturbative order with \eqref{eq:dyson-series}. 
\end{enumerate}

When we write the Hamiltonian, we always mean the \textbf{normal-ordered} Hamiltonian. 

\begin{definition}
The \(S\)-matrix evolution operator is given by:
%
\begin{align}
S = U_I (- \infty , \infty )
&= T \qty[\exp(-i \int_{- \infty }^{\infty } \dd{\tau }H _{\text{int}}^{I} (\tau ))]  \\
&= T \qty[\exp(-i \int \dd[4]{x} \mathscr{H} _{\text{int}}^{I} (x))]
\,.
\end{align}
\end{definition}

This object describes all the interaction that can happen over all of time (this is used when describing actual interactions, temporal infinity is asymptotically the same as the particles flying away and not interacting anymore).

In the calculation of such an object, we will need to compute products such as 
%
\begin{align}
T \qty[\mathscr{H} _{\text{int}}^{I}(x_1 ) \mathscr{H} _{\text{int}}^{I}(x_2 )] 
= T \qty[ N[\overline{\psi} \slashed{A} \psi ]_{x_1 }N[\overline{\psi} \slashed{A} \psi ]_{x_2 }]
\,,
\end{align}
%
where we wrote the QED interaction Hamiltonian density. The way to compute these objects is to make use of \textbf{Wick's theorem}. 

\subsection{Wick theorem for a real scalar field}

We start from the simplest case and then generalize to more complex ones. 

\begin{definition}
The \textbf{Feynman propagator} for a real scalar field is defined as 
%
\begin{align}
D_F (x-y) = \bra{0} T[\varphi (x) \varphi (y)] \ket{0} 
\,.
\end{align}
\end{definition}
\todo[inline]{Also written by connecting two \(\varphi \)s with a line underneath, to figure out how to tex it.}

Now, from the definition of the time-ordered product we have that 
%
\begin{align}
D_F (x-y) &= 
[x_0 > y_0 ]
\bra{0} \varphi (x) \varphi (y) \ket{0}
+
[x_0 < y_0 ]
\bra{0} \varphi (y) \varphi (x) \ket{0}  \\
&= 
[x_0 > y_0 ]
\bra{0} \varphi_{+} (x) \varphi_{-} (y) \ket{0}
+
[x_0 < y_0 ]
\bra{0} \varphi_{+} (y) \varphi_{-} (x) \ket{0}  \\
&= 
[x_0 > y_0 ]
D_+ (x-y)
-
[x_0 < y_0 ]
D_- (x-y) 
\,,
\end{align}
%
since \(\varphi_{+} \ket{0} = 0\) and \(\bra{0} \varphi_{-} = 0 \), as \(\varphi_{+} \sim a\) and \(\varphi_{-} \sim a ^\dag\).

Here \(D_{\pm}\) are the components of the covariant commutator defined in section \ref{sec:covariant-commutators}. 

Then, the crucial statement is that
\begin{claim}
\begin{align}
T [\varphi (x) \varphi (y)] = N[\varphi (x) \varphi (y)] + D_F (x-y)
\,.
\end{align}
\end{claim}

\begin{proof}
We prove this by writing the term \(T[\varphi \varphi ] - N[ \varphi \varphi ]\) explicitly: we get 
%
\begin{align}
& T[\varphi (x)\varphi (y)] - N[\varphi (x) \varphi (y)] = \\
\begin{split}
&= [x_0 > y_0 ] \qty(\varphi (x) \varphi (y)) + [x_0 < y_0 ] \qty(\varphi (y) \varphi (x)) \\
& 
- \qty([x_0 > y_0 ] + [x_0 < y_0 ]) N [\varphi (x)\varphi (y)] 
\end{split}  \\
\begin{split}
&= 
[x_0 > y_0 ] \qty(\varphi_{-} (x) \varphi_{-} (y) + \varphi_{+} (x) \varphi_{+} (y) + \varphi_{-} (x) \varphi_{+} (y) + \hlc{teal}{\varphi_{+} (x) \varphi_{-} (y)}) \\
& 
+ 
[x_0 < y_0 ] \qty(\varphi_{-} (y) \varphi_{-} (x) + \varphi_{+} (y) \varphi_{+} (x) + \varphi_{-} (y) \varphi_{+} (x) + \hlc{teal}{\varphi_{+} (y) \varphi_{-} (x)}) 
\\
& 
-
[x_0 > y_0 ]
\qty(\varphi_{-} (x) \varphi_{-} (y) + \varphi_{+} (x) \varphi_{+} (y) + \varphi_{-} (x) \varphi_{+} (y) + \hlc{teal}{\varphi_{-} (y) \varphi_{+} (x)} ) 
\\
& 
-
[x_0 < y_0 ]
\qty(\varphi_{-} (x) \varphi_{-} (y) + \varphi_{+} (x) \varphi_{+} (y) + \varphi_{-} (x) \varphi_{+} (y) + \hlc{teal}{\varphi_{-} (y) \varphi_{+} (x)} ) 
\end{split}  \\
&= [x_0 > y_0 ] \qty(\varphi_{+} (x) \varphi_{-} (y) - \varphi_{-} (y) \varphi_{+} (x))
- [x_0 < y_0 ] \qty(\varphi_{-} (x) \varphi_{+} (y) - \varphi_{+}(y) \varphi_{-}(x))  \\
&= 
[x_0 > y_0 ]
D_+ (x-y)
-
[x_0 < y_0 ]
D_- (x-y) \\
&= D_F (x-y)
\,.
\end{align}
\end{proof}

Wick's theorem for scalar fields is the generalization of this result to \(n\) fields: 
It states that 
%
\begin{align}
\begin{split}
T [\varphi (x_1 ) \varphi (x_2 ) \dots \varphi (x_n)]
&=
N [\varphi (x_1 ) \varphi (x_2 )\dots \varphi (x_n)] \\
&+ \sum_{i} N[\varphi (x_1 )\dots \varphi (x_{i-1}) D_F (x_i- x_{i+1}) \varphi (x_{i+2}) \dots \varphi (x_n)]  \\
&+ \sum _{ij}
N[\varphi (x_1 )\dots \varphi (x_{i-1}) D_F (x_i- x_{i+1}) \varphi (x_{i+2}) \dots \\
& \dots \varphi (x_{j-1}) D_F (x_j- x_{j+1}) \varphi (x_{j+2}) \dots \varphi (x_n)]  \\
&+ \text{all possible contractions}
\,.
\end{split}
\end{align}

A \textbf{corollary} of Wick's theorem states that contractions of fields evaluated at the same time do not contribute to the \(T\)-product. Formally, this is stated as: 
%
\begin{align}
T \qty[N[\varphi (x) \varphi (x)] \varphi (x_1 )\dots \varphi (x_n)]
= T \qty[\varphi^2(x) \varphi (x_1 )\dots \varphi (x_n)] _{\text{NCET}}
\,,
\end{align}
%
where the left hand side contains No Contractions at Equal Time --- that is, when we compute the time-ordered product using Wick's theorem we ignore the contractions we would have to compute at equal time.

\begin{proof}
The product \(N[\varphi (x) \varphi (x)]\) can be written, by Wick's theorem, as
%
\begin{align}
N[\varphi (x) \varphi (x)] = T[\varphi (x) \varphi (x)] - D_F (x - x)
\,,
\end{align}
%
where \(T[\varphi (x) \varphi (x)] = \varphi (x) \varphi (x)\). So, if we multiply by the field at the other times and take the time-ordering we find 
%
\begin{align}
T \qty[N[\varphi (x) \varphi (x)] \varphi (x_1 )\dots \varphi (x_n)]
= T[\varphi^2(x) \varphi_1 (x) \dots \varphi_n (x)]
- D_F(x-x) T[\varphi_1 (x) \dots \varphi_n (x)] 
\,,
\end{align}
%
and the term containing \(D_F( x-x)\) is precisely a contraction at equal time, which we ignore. 
\end{proof}

This statement can be \textbf{generalized} to complex scalar fields and to vector fields. 

\begin{definition}
For a complex scalar field \(\varphi \), the Feynman propagator is given by 
%
\begin{align}
D_F (x-y) = \bra{0} T [\varphi (x) \varphi ^\dag (x)] \ket{0}
\,.
\end{align}
\end{definition}

\begin{claim}
This is the same function which was calculated for the real scalar field; one can show that the other contractions vanish: 
%
\begin{align}
\bra{0} T[\varphi (x) \varphi (x)] \ket{0} 
= 0 = 
\bra{0} T[\varphi ^\dag(x) \varphi ^\dag (x)] \ket{0} 
\,.
\end{align}
\end{claim}

\begin{proof}
\todo[inline]{Still to state properly, but this is due to the fact that \(a\) (\(a ^\dag\)) and \(b\) (\(b ^\dag\)) commute with each other, whereas \(a\) does not commute with \(a ^\dag\).}
\end{proof}

\begin{definition}
For a real vector field \(A^{\mu }\) and a complex vector field \(\omega^{\mu }\) the Feynman propagator reads: 
%
\begin{align}
D^{\mu \nu }_{F, \text{ real}} (x-y) &= \bra{0} T[A^{\mu }(x) A^{\nu }(y) ]\ket{0} \\
D^{\mu \nu }_{F, \text{ complex}} (x-y) &= \bra{0} T[\omega^{\mu }(x) \omega^{\nu \dag}(y) ]\ket{0}
\,.
\end{align}
\end{definition}

\begin{claim}
In the Feynman gauge \(\xi = 1\) we have that 
%
\begin{align}
D^{\mu \nu }_{F} (x-y) = [x_0 > y_0 ]
D^{\mu \nu }_{+ } (x-y) 
+
[x_0 < y_0 ]
D^{\mu \nu }_{-}(x-y) 
= - \eta^{\mu \nu } D_F (x-y)
\,.
\end{align}
\end{claim}

Note that for a complex vector field the propagators between \(\omega^{\mu } \omega^{\nu }\) and \(\omega^{\mu \dag} \omega^{\nu \dag}\) vanish. 

The Wick theorem generalizes to the complex scalar, and to the real and complex vector: we have 
%
\begin{align}
T[\varphi (x) \varphi ^\dag (y)] &= N[\varphi (x) \varphi ^\dag (y)] + D_F (x-y) \\
T[A^{\mu } (x) A^{\nu } (y)] &= N[A^{\mu } (x) A^{\nu } (y)] + D_F^{\mu \nu } (x-y) \\
T[\omega^{\mu } (x) \omega^{\nu  \dag} (y)] &= N[\omega^{\mu } (x) \omega^{\nu \dag } (y)] + D_F^{\mu \nu } (x-y) 
\,.
\end{align}

\subsection{Feynman propagator for fermions}

For fermionic fields the discussion gets a little more complicated because of the minus signs coming from the anticommutators. 

\begin{definition}
The Feynman propagator for fermions is defined as 
%
\begin{align}
S^{F}_{\alpha \beta } (x-y)
&= \bra{0}T[\psi_{\alpha }(x) \overline{\psi}_{\beta }(y)] \ket{0}
= - \bra{0} T[\overline{\psi}_\alpha (x) \psi_{\beta }(y)] \ket{0}
\,.
\end{align}
\end{definition}

\begin{claim}
We have the following expression for the propagator: 
%
\begin{align}
S_F(x-y) &= [x_0 > y_0 ] S_+ (x-y) - [x_0 < y_0 ] S_- (x-y)  \\
&= \qty(i \slashed{\partial} + m) D_F (x-y)
\,.
\end{align}
\end{claim}

\todo[inline]{Missing some indices?}

\begin{claim}
Wick's theorem holds in this case as well: 
%
\begin{align}
T[\psi_{\alpha }(x) \overline{\psi}_{\beta }(y)]
= N [\psi_{\alpha }(x) \overline{\psi}_{\beta }(y)]
+ S^{F}_{\alpha \beta }
\,.
\end{align}
\end{claim}

\begin{proof}
Let us write explicitly the difference \(T[\psi \overline{\psi}] - N[\psi \overline{\psi}]\). We find something that is similar to the scalar case, but there is a crucial difference: instead of commuting operators when we switch them around for normal or time ordering, we anticommute them, so we swap their positions and change the sign. This then yields: 
%
\begin{align}
&T[\psi_{\alpha } (x) \overline{\psi}_{\beta } (y)] - N[\psi_{\alpha } (x) \overline{\psi}_{\beta } (y)] = \\
\begin{split}
&= 
[x_0 > y_0 ] \qty(
    \psi_{\alpha }^{-} (x) \overline{\psi}^{-}_{\beta }(y)+
    \psi_{\alpha }^{+} (x) \overline{\psi}^{+}_{\beta }(y)+
    \psi_{\alpha }^{-} (x) \overline{\psi}^{+}_{\beta }(y)+
    \psi_{\alpha }^{+} (x) \overline{\psi}^{-}_{\beta }(y)
) \\
&-
[x_0 < y_0 ]\qty(
    \overline{\psi}_{\beta }^{-} (y) \psi^{-}_{\alpha } (x)+
    \overline{\psi}_{\beta }^{+} (y) \psi^{+}_{\alpha } (x)+
    \overline{\psi}_{\beta }^{-} (y) \psi^{+}_{\alpha } (x)+
    \overline{\psi}_{\beta }^{+} (y) \psi^{-}_{\alpha } (x)
)  \\
&- 
[x_0 > y_0 ] \qty(
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{-}(y)+
    \psi_{\alpha }^{+}(x) \overline{\psi}_{\beta }^{+}(y)+
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{+}(y)-
    \overline{\psi}_{\beta }^{-}(y) \psi_{\alpha }^{+}(x) 
)\\
&- 
[x_0 < y_0 ] \qty(
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{-}(y)+
    \psi_{\alpha }^{+}(x) \overline{\psi}_{\beta }^{+}(y)+
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{+}(y)-
    \overline{\psi}_{\beta }^{-}(y) \psi_{\alpha }^{+}(x) 
)
\end{split}\\
\begin{split}
&= [x_0 > y_0 ]\qty(
    \psi_{\alpha }^{-} (x) \overline{\psi}^{+}_{\beta }(y)+
    \psi_{\alpha }^{+} (x) \overline{\psi}^{-}_{\beta }(y)-
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{+}(y)+
    \overline{\psi}_{\beta }^{-}(y) \psi_{\alpha }^{+}(x) 
) \\ 
&+
[x_0 < y_0 ]\bigg(-
    \overline{\psi}_{\beta }^{-} (y) \psi^{-}_{\alpha } (x)-
    \overline{\psi}_{\beta }^{+} (y) \psi^{+}_{\alpha } (x)-
    \overline{\psi}_{\beta }^{-} (y) \psi^{+}_{\alpha } (x)-
    \overline{\psi}_{\beta }^{+} (y) \psi^{-}_{\alpha } (x)+\\
    &\phantom{=}\ 
    -\psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{-}(y)-
    \psi_{\alpha }^{+}(x) \overline{\psi}_{\beta }^{+}(y)-
    \psi_{\alpha }^{-}(x) \overline{\psi}_{\beta }^{+}(y)+
    \overline{\psi}_{\beta }^{-}(y) \psi_{\alpha }^{+}(x) 
\bigg)
\end{split}
\,.
\end{align}

\todo[inline]{Man, this is a tedious calculation}
\end{proof}

\subsection{General statement of Wick's theorem}

We denote by \(B_i (x_i)\) a generic field, which may be real or complex, of spin 0, \(1/2\) or 1. Then, Wick's theorem states that \textbf{the \(T\)-product of \(n\) such fields can be written as}: 
%
\begin{align}
\begin{split}
& T[B_1 (x_1 ) B_2 (x_2 ) \dots B_n (x_n)]= \\
&= N[B_1 (x_1 ) B_2 (x_2 ) \dots B_n (x_n)]  \\
&+ \sum _{ij} (-)^{P_{ij}} D_F^{ij}(x_i - x_j) N[ \dots \hat{B}_{i}(x_i) \hat{B}_{j}(x_j)\dots]  \\
&+ \sum _{ijkl} (-)^{P_{ij}+P_{kl}} D_F^{ij}(x_i - x_j) D_F^{kl}(x_k - x_l)  N[\dots \hat{B}_{i}(x_i) \hat{B}_{i}(x_j)\dots \hat{B}_{k}(x_k) \hat{B}_{l}(x_l)\dots]  \\
&+ \dots \,,
\end{split}
\end{align}
%
where \(P_{ij}\) is the number of fermion operator swaps we need to perform to bring \(B_i\) and \(B_j\) to the front; the normal-ordered product with \(\hat{B}_i\) means that it is taken removing \(B_i\). 

\todo[inline]{``Taking out fermionic propagators has a meaning only as components'': what does this mean?}

Note that, while we are summing over all possible pairings, the only nonvanishing propagators are those between two copies of the same field. 

We have the same \textbf{corollary} as before: normal-ordered contractions of fields at the same time do not contribute; we have 
%
\begin{align}
T \qty[N[B_1 (x) B_2 (x)] B_3 (x_3 ) \dots B_n (x_n)] 
= T \qty[B_1 (x) B_2 (x) B_3 (x_3) \dots B_n (n_n)]_{NCET}
\,.
\end{align}

\subsection{Feynman propagators}

The Feynman propagators play a central role in the perturbative expansion. What is their physical interpretation?

\subsubsection{Real scalar}

As we saw, the propagator for a real scalar field can be written in terms of the Vacuum Expectation Value of the fields as:
%
\begin{align}
D_F(x-y) = [x_0 > y_0 ] \bra{0} \varphi_+ (x) \varphi_{-} (y) \ket{0}
+ [x_0 < y_0 ] \bra{0}\varphi_{+} (y) \varphi_{-}(x) \ket{0}
\,.
\end{align}

What do these pieces mean? Let us first consider the case where \(x_0 > y_0 \): then we only have 
%
\begin{align}
D_F (x-y) = \bra{0} \varphi_{+} (x) \varphi_{-} (y) \ket{0} \sim \bra{0} a a ^\dag \ket{0}
\,,
\end{align}
%
which can be read from right to left as: 
\begin{enumerate}
    \item we start from the vacuum \(\ket{0}\);
    \item we apply the operator \(\varphi_{-} (y)\), which creates a particle of indeterminate momentum at the position \(y\);
    \item the particle is destroyed at the position \(x\) by the operator \(\varphi_{+}(x)\);
    \item we return to the vacuum state \(\bra{0}\). 
\end{enumerate}

This can be represented graphically as shown in 

\begin{figure}[ht]
\centering
\begin{tikzpicture}
\begin{feynman}
\vertex (y) {\(y\)};    
\vertex [below right = 2cm and 2cm of y] (x) {\(x\)};
\vertex [right = 4cm of y] (y0) {\(y_0 \)};
\vertex [below right = 2cm and 4cm of y] (x0) {\(x_0 \)};
\diagram*{
    (y)  -- [scalar, momentum] (x),
    (y0) -- [fermion, edge label = \(t\)] (x0)
};
\end{feynman}
\end{tikzpicture}
\caption{Virtual scalar particle. Time is shown as going downward, the diagram shows the virtual scalar particle being created at \(y\) and then destroyed at \(x\).}
\label{fig:virtual-scalar-particle-diagram-1}
\end{figure}

Now, let us consider the other case: \(x_0 < y_0 \). Now, the second term contributes, so we have 
%
\begin{align}
D_F (x-y) = \bra{0} \varphi_{+} (y) \varphi_{-} (x) \ket{0} \sim \bra{0} a a ^\dag \ket{0}
\,,
\end{align}
%
so we can interpret it again as: 
\begin{enumerate}
    \item we start from the vacuum \(\ket{0}\);
    \item we apply the operator \(\varphi_{-} (x)\), which creates a particle of indeterminate momentum at the position \(x\);
    \item the particle is destroyed at the position \(y\) by the operator \(\varphi_{+}(y)\);
    \item we return to the vacuum state \(\bra{0}\). 
\end{enumerate}

\begin{figure}[ht]
\centering
\begin{tikzpicture}
\begin{feynman}
\vertex (x) {\(x\)};    
\vertex [below left = 2cm and 2cm of x] (y) {\(y\)};
\vertex [right = 2cm of x] (x0) {\(x_0 \)};
\vertex [below right = 2cm and 2cm of x] (y0) {\(y_0 \)};
\diagram*{
    (x)  -- [scalar, momentum] (y),
    (x0) -- [fermion, edge label = \(t\)] (y0)
};
\end{feynman}
\end{tikzpicture}
\caption{Virtual scalar particle. Time is shown as going downward, the diagram shows the virtual scalar particle being created at \(x\) and then destroyed at \(y\).}
\label{fig:virtual-scalar-particle-diagram-2}
\end{figure}

Neither of these two is Lorentz invariant; however the full propagator is. So, we depict it as shown in figure \ref{fig:virtual-scalar-particle-diagram}.

\begin{figure}[ht]
\centering
\feynmandiagram [horizontal = x to y]{
    x [particle=\(x\)] -- [scalar, momentum=\(a\), reversed momentum'=\(a\)] y [particle=\(y\)]
};
\caption{Scalar virtual particle. Time goes either upward or downward.}
\label{fig:virtual-scalar-particle-diagram}
\end{figure}

\todo[inline]{What does \(a\) mean here?}

A note of caution: the diagrammatic approach is nice but it does not represent the physical trajectory of a particle, since it does not enforce it being on shell. 
Nevertheless, just like a quantum particle can tunnel through a potential barrier higher than its energy, the propagator describes a probabilistic physical process.

\subsubsection{Explicit calculation of the scalar propagator}

Starting from the expression we derived in an earlier chapter for the propagator \eqref{eq:scalar-field-propagator} as an integral in momentum space, we can write 
%
\begin{align}
D_F (x-y) &= [x_0 > y_0 ] D_+ (x-y) + [x_0 < y_0 ] D_- (x-y)  \\
&= \frac{1}{(2 \pi )^3} \int \frac{ \dd[3]{k}}{\sqrt{2 \omega_{k}}}
\qty[[x_0 > y_0 ] e^{-ik(x-y)} + [x_0 < y_0 ] e^{ik(x-y)}]  \\
&= i \int_{C_F} \frac{ \dd[4]{k}}{(2 \pi )^{4}}\frac{e^{-ik(x-y)}}{k^2-m^2}\\
&= \int_{C_F} \frac{ \dd[4]{k}}{(2 \pi )^{4}} \widetilde{D}_{F} (k)
\,.
\end{align}

This defines the scalar propagator in momentum space 
%
\begin{align}
\widetilde{D}_{F}(k) = \frac{i}{k^2- m^2}
\,,
\end{align}
%
while the integration region is \(\mathbb{R}^{3}\) for the coordinates \(\vec{k}\), and for the coordinate \(k^{0}\) it is a contour following the real axis rightward, except for circling the singularity \(k_0 = - \omega_{k}\) from below, and \(k^{0} = \omega_{k}\) from above. 

This shows explicitly that the propagator \emph{must} represent an \textbf{off-shell} particle: we must have \(k^2 \neq m^2\), otherwise the propagator diverges.

\subsubsection{Complex scalar field}

For the complex scalar field we have that 
%
\begin{align}
\varphi_{+} &\sim a(k) e^{-ikx} 
&
\varphi_{-} &\sim b ^\dag(k) e^{ikx}  \\
\varphi_{+}^\dag &\sim b(k) e^{-ikx} 
&
\varphi_{-}^\dag &\sim a ^\dag(k) e^{ikx}
\,.
\end{align}

So, the propagator is given by 
%
\begin{align}
D_F (x-y) &= \bra{0} T [\varphi (x) \varphi ^\dag (y)] \ket{0}  \\
&= 
\,,
\end{align}
%


\end{document}